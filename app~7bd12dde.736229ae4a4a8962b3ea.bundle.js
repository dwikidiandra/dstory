"use strict";(self.webpackChunkapp_starter_project_with_webpack=self.webpackChunkapp_starter_project_with_webpack||[]).push([[71],{24:(e,t,r)=>{r.d(t,{A:()=>f});var n=r(848),a=r(467),o=r(29),s=r(901),c=r(756),i=r.n(c),u=r(148),p=r(559);function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach((function(t){(0,n.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const f=new(function(){return(0,s.A)((function e(){(0,o.A)(this,e),this._dbPromise=this._initDb()}),[{key:"_initDb",value:(h=(0,a.A)(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.P2)(p.A.BOOKMARK_DATABASE_NAME,p.A.DATABASE_VERSION,{upgrade:function(e){e.objectStoreNames.contains(p.A.BOOKMARK_OBJECT_STORE_NAME)||e.createObjectStore(p.A.BOOKMARK_OBJECT_STORE_NAME,{keyPath:"id"})}}));case 1:case"end":return e.stop()}}),e)}))),function(){return h.apply(this,arguments)})},{key:"getAllBookmarks",value:(c=(0,a.A)(i().mark((function e(){var t,r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._dbPromise;case 3:return t=e.sent,e.next=6,t.getAll(p.A.BOOKMARK_OBJECT_STORE_NAME);case 6:return r=e.sent,e.abrupt("return",r||[]);case 10:return e.prev=10,e.t0=e.catch(0),e.abrupt("return",[]);case 14:case"end":return e.stop()}}),e,this,[[0,10]])}))),function(){return c.apply(this,arguments)})},{key:"getBookmark",value:(n=(0,a.A)(i().mark((function e(t){var r,n,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._dbPromise;case 3:return r=e.sent,n=r.transaction(p.A.BOOKMARK_OBJECT_STORE_NAME,"readonly"),a=n.objectStore(p.A.BOOKMARK_OBJECT_STORE_NAME),e.abrupt("return",a.get(t));case 9:throw e.prev=9,e.t0=e.catch(0),e.t0;case 13:case"end":return e.stop()}}),e,this,[[0,9]])}))),function(e){return n.apply(this,arguments)})},{key:"addBookmark",value:(r=(0,a.A)(i().mark((function e(t){var r,n,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._dbPromise;case 3:return r=e.sent,n=r.transaction(p.A.BOOKMARK_OBJECT_STORE_NAME,"readwrite"),a=n.objectStore(p.A.BOOKMARK_OBJECT_STORE_NAME),e.abrupt("return",a.put(l(l({},t),{},{createdAt:(new Date).toISOString()})));case 9:throw e.prev=9,e.t0=e.catch(0),e.t0;case 13:case"end":return e.stop()}}),e,this,[[0,9]])}))),function(e){return r.apply(this,arguments)})},{key:"removeBookmark",value:(t=(0,a.A)(i().mark((function e(t){var r,n,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._dbPromise;case 3:return r=e.sent,n=r.transaction(p.A.BOOKMARK_OBJECT_STORE_NAME,"readwrite"),a=n.objectStore(p.A.BOOKMARK_OBJECT_STORE_NAME),e.abrupt("return",a.delete(t));case 9:throw e.prev=9,e.t0=e.catch(0),e.t0;case 13:case"end":return e.stop()}}),e,this,[[0,9]])}))),function(e){return t.apply(this,arguments)})},{key:"isBookmarked",value:(e=(0,a.A)(i().mark((function e(t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.getBookmark(t);case 3:return r=e.sent,e.abrupt("return",!!r);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",!1);case 11:case"end":return e.stop()}}),e,this,[[0,7]])}))),function(t){return e.apply(this,arguments)})}]);var e,t,r,n,c,h}())},263:(e,t,r)=>{e.exports=r.p+"images/dlogoee13974096acf2b65cdf.png"},559:(e,t,r)=>{r.d(t,{A:()=>n});const n={BASE_URL:"https://story-api.dicoding.dev/v1",VAPID_PUBLIC_KEY:"BCCs2eonMI-6H2ctvFaWg-UYdDv387Vno_bzUzALpB442r2lCnsHmtrx8biyPi_E-1fSGABK_Qs_GlvPoJJqxbk",DEFAULT_MAP_CENTER:[-6.2088,106.8456],DEFAULT_MAP_ZOOM:5,CACHE_NAME:"dicoding-story-v1",DATABASE_NAME:"dicoding-story-database",DATABASE_VERSION:1,BOOKMARK_DATABASE_NAME:"dicoding-story-bookmarks",BOOKMARK_OBJECT_STORE_NAME:"bookmarks",OBJECT_STORE_NAME:"stories",MAX_FILE_SIZE:1048576,API_TIMEOUT:8e3}},702:(e,t,r)=>{r.d(t,{A:()=>u});var n=r(467),a=r(29),o=r(901),s=r(756),c=r.n(s),i=r(922);const u=function(){return(0,o.A)((function e(){(0,a.A)(this,e)}),null,[{key:"isUserLoggedIn",value:function(){return!!this.getUserToken()}},{key:"getUserToken",value:function(){return localStorage.getItem("token")}},{key:"getUserName",value:function(){return localStorage.getItem("name")}},{key:"register",value:(t=(0,n.A)(c().mark((function e(t){var r,n,a,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.name,n=t.email,a=t.password,e.next=3,i.A.register({name:r,email:n,password:a});case 3:return o=e.sent,e.abrupt("return",o);case 5:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})},{key:"login",value:(e=(0,n.A)(c().mark((function e(t){var r,n,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.email,n=t.password,e.next=3,i.A.login({email:r,password:n});case 3:return a=e.sent,localStorage.setItem("token",a.loginResult.token),localStorage.setItem("name",a.loginResult.name),localStorage.setItem("userId",a.loginResult.userId),window.location.hash="#/",e.abrupt("return",a);case 9:case"end":return e.stop()}}),e)}))),function(t){return e.apply(this,arguments)})},{key:"logout",value:function(){localStorage.removeItem("token"),localStorage.removeItem("name"),localStorage.removeItem("userId"),window.location.hash="#/login"}}]);var e,t}()},922:(e,t,r)=>{r.d(t,{A:()=>l});var n=r(848),a=r(467),o=r(29),s=r(901),c=r(756),i=r.n(c),u=r(559);function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){(0,n.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const l=function(){return(0,s.A)((function e(){(0,o.A)(this,e)}),null,[{key:"_handleResponse",value:(v=(0,a.A)(i().mark((function e(t){var r,n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.json();case 2:if(r=e.sent,t.ok){e.next=6;break}throw n=r.message||"Request failed with status ".concat(t.status),new Error(n);case 6:return e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)}))),function(e){return v.apply(this,arguments)})},{key:"_fetchWithTimeout",value:(d=(0,a.A)(i().mark((function e(t){var r,n,a,o,s,c,p=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(r=p.length>1&&void 0!==p[1]?p[1]:{}).timeout,a=void 0===n?u.A.API_TIMEOUT:n,o=new AbortController,s=setTimeout((function(){return o.abort()}),a),e.prev=4,e.next=7,fetch(t,h(h({},r),{},{signal:o.signal}));case 7:return c=e.sent,clearTimeout(s),e.abrupt("return",c);case 12:if(e.prev=12,e.t0=e.catch(4),clearTimeout(s),"AbortError"!==e.t0.name){e.next=17;break}throw new Error("Request timeout. Please check your connection and try again.");case 17:throw new Error("Network error. Please check your internet connection.");case 18:case"end":return e.stop()}}),e,null,[[4,12]])}))),function(e){return d.apply(this,arguments)})},{key:"register",value:(f=(0,a.A)(i().mark((function e(t){var r,n,a,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.name,n=t.email,a=t.password,e.prev=1,e.next=4,this._fetchWithTimeout("".concat(u.A.BASE_URL,"/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:r,email:n,password:a})});case 4:return o=e.sent,e.abrupt("return",this._handleResponse(o));case 8:throw e.prev=8,e.t0=e.catch(1),new Error(e.t0.message||"Registration failed. Please try again.");case 12:case"end":return e.stop()}}),e,this,[[1,8]])}))),function(e){return f.apply(this,arguments)})},{key:"login",value:(l=(0,a.A)(i().mark((function e(t){var r,n,a,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.email,n=t.password,e.prev=1,e.next=4,this._fetchWithTimeout("".concat(u.A.BASE_URL,"/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r,password:n})});case 4:return a=e.sent,e.next=7,this._handleResponse(a);case 7:if((o=e.sent).loginResult&&o.loginResult.token){e.next=10;break}throw new Error("Invalid response from server");case 10:return e.abrupt("return",o);case 13:throw e.prev=13,e.t0=e.catch(1),new Error(e.t0.message||"Login failed. Please check your credentials.");case 17:case"end":return e.stop()}}),e,this,[[1,13]])}))),function(e){return l.apply(this,arguments)})},{key:"getAllStories",value:(p=(0,a.A)(i().mark((function e(t){var r,n,a,o,s,c,p,h,l;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.token,n=t.page,a=void 0===n?1:n,o=t.size,s=void 0===o?10:o,c=t.location,p=void 0===c?0:c,e.prev=1,e.next=4,this._fetchWithTimeout("".concat(u.A.BASE_URL,"/stories?page=").concat(a,"&size=").concat(s,"&location=").concat(p),{headers:{Authorization:"Bearer ".concat(r)}});case 4:return h=e.sent,e.next=7,this._handleResponse(h);case 7:if(l=e.sent,Array.isArray(l.listStory)){e.next=10;break}throw new Error("Invalid stories data format");case 10:return e.abrupt("return",l.listStory);case 13:throw e.prev=13,e.t0=e.catch(1),new Error(e.t0.message||"Failed to load stories. Please try again.");case 17:case"end":return e.stop()}}),e,this,[[1,13]])}))),function(e){return p.apply(this,arguments)})},{key:"getStoryDetail",value:(c=(0,a.A)(i().mark((function e(t,r){var n,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._fetchWithTimeout("".concat(u.A.BASE_URL,"/stories/").concat(t),{headers:{Authorization:"Bearer ".concat(r)}});case 3:return n=e.sent,e.next=6,this._handleResponse(n);case 6:if((a=e.sent).story){e.next=9;break}throw new Error("Story not found");case 9:return e.abrupt("return",a.story);case 12:throw e.prev=12,e.t0=e.catch(0),new Error(e.t0.message||"Failed to load story details.");case 16:case"end":return e.stop()}}),e,this,[[0,12]])}))),function(e,t){return c.apply(this,arguments)})},{key:"addNewStory",value:(n=(0,a.A)(i().mark((function e(t){var r,n,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.token,n=t.data,e.prev=1,n instanceof FormData){e.next=4;break}throw new Error("Invalid data format");case 4:return e.next=6,this._fetchWithTimeout("".concat(u.A.BASE_URL,"/stories"),{method:"POST",headers:{Authorization:"Bearer ".concat(r)},body:n});case 6:return a=e.sent,e.abrupt("return",this._handleResponse(a));case 10:throw e.prev=10,e.t0=e.catch(1),new Error(e.t0.message||"Failed to add story. Please try again.");case 14:case"end":return e.stop()}}),e,this,[[1,10]])}))),function(e){return n.apply(this,arguments)})},{key:"addNewStoryGuest",value:(r=(0,a.A)(i().mark((function e(t){var r,n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.data,e.prev=1,e.next=4,this._fetchWithTimeout("".concat(u.A.BASE_URL,"/stories/guest"),{method:"POST",body:r});case 4:return n=e.sent,e.abrupt("return",this._handleResponse(n));case 8:throw e.prev=8,e.t0=e.catch(1),new Error(e.t0.message||"Failed to add story. Please try again.");case 12:case"end":return e.stop()}}),e,this,[[1,8]])}))),function(e){return r.apply(this,arguments)})},{key:"subscribePushNotification",value:(t=(0,a.A)(i().mark((function e(t){var r,n,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.token,n=t.subscription,e.prev=1,e.next=4,this._fetchWithTimeout("".concat(u.A.BASE_URL,"/notifications/subscribe"),{method:"POST",headers:{Authorization:"Bearer ".concat(r),"Content-Type":"application/json"},body:JSON.stringify(n)});case 4:return a=e.sent,e.abrupt("return",this._handleResponse(a));case 8:throw e.prev=8,e.t0=e.catch(1),new Error(e.t0.message||"Failed to subscribe to notifications.");case 12:case"end":return e.stop()}}),e,this,[[1,8]])}))),function(e){return t.apply(this,arguments)})},{key:"unsubscribePushNotification",value:(e=(0,a.A)(i().mark((function e(t){var r,n,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.token,n=t.endpoint,e.prev=1,e.next=4,this._fetchWithTimeout("".concat(u.A.BASE_URL,"/notifications/subscribe"),{method:"DELETE",headers:{Authorization:"Bearer ".concat(r),"Content-Type":"application/json"},body:JSON.stringify({endpoint:n})});case 4:return a=e.sent,e.abrupt("return",this._handleResponse(a));case 8:throw e.prev=8,e.t0=e.catch(1),new Error(e.t0.message||"Failed to unsubscribe from notifications.");case 12:case"end":return e.stop()}}),e,this,[[1,8]])}))),function(t){return e.apply(this,arguments)})}]);var e,t,r,n,c,p,l,f,d,v}()},965:(e,t,r)=>{r.d(t,{A:()=>v});var n=r(75),a=r(467),o=r(29),s=r(901),c=r(756),i=r.n(c),u=r(922),p=r(559);const h=new(function(){return(0,s.A)((function e(){(0,o.A)(this,e),this._dbPromise=this._openDB()}),[{key:"_openDB",value:function(){return new Promise((function(e,t){var r=indexedDB.open(p.A.DATABASE_NAME,p.A.DATABASE_VERSION);r.onupgradeneeded=function(e){var t=e.target.result;if(!t.objectStoreNames.contains(p.A.OBJECT_STORE_NAME)){var r=t.createObjectStore(p.A.OBJECT_STORE_NAME,{keyPath:"id"});r.createIndex("createdAt","createdAt",{unique:!1}),r.createIndex("name","name",{unique:!1})}t.objectStoreNames.contains("bookmarks")||t.createObjectStore("bookmarks",{keyPath:"id"}).createIndex("storyId","storyId",{unique:!0})},r.onsuccess=function(){e(r.result)},r.onerror=function(e){t(e.target.error)}}))}},{key:"getStory",value:(d=(0,a.A)(i().mark((function e(t){var r,n,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._dbPromise;case 3:return r=e.sent,n=r.transaction(p.A.OBJECT_STORE_NAME,"readonly"),a=n.objectStore(p.A.OBJECT_STORE_NAME),e.abrupt("return",a.get(t));case 9:throw e.prev=9,e.t0=e.catch(0),e.t0;case 13:case"end":return e.stop()}}),e,this,[[0,9]])}))),function(e){return d.apply(this,arguments)})},{key:"getAllStories",value:(f=(0,a.A)(i().mark((function e(){var t,r,n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._dbPromise;case 3:return t=e.sent,r=t.transaction(p.A.OBJECT_STORE_NAME,"readonly"),n=r.objectStore(p.A.OBJECT_STORE_NAME),e.abrupt("return",n.getAll());case 9:throw e.prev=9,e.t0=e.catch(0),e.t0;case 13:case"end":return e.stop()}}),e,this,[[0,9]])}))),function(){return f.apply(this,arguments)})},{key:"putStory",value:(l=(0,a.A)(i().mark((function e(t){var r,n,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._dbPromise;case 3:return r=e.sent,n=r.transaction(p.A.OBJECT_STORE_NAME,"readwrite"),a=n.objectStore(p.A.OBJECT_STORE_NAME),e.abrupt("return",a.put(t));case 9:throw e.prev=9,e.t0=e.catch(0),e.t0;case 13:case"end":return e.stop()}}),e,this,[[0,9]])}))),function(e){return l.apply(this,arguments)})},{key:"putStories",value:(h=(0,a.A)(i().mark((function e(t){var r,n,a,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._dbPromise;case 3:return r=e.sent,n=r.transaction(p.A.OBJECT_STORE_NAME,"readwrite"),a=n.objectStore(p.A.OBJECT_STORE_NAME),o=t.map((function(e){return a.put(e)})),e.next=9,Promise.all(o);case 9:return e.abrupt("return",n.complete);case 12:throw e.prev=12,e.t0=e.catch(0),e.t0;case 16:case"end":return e.stop()}}),e,this,[[0,12]])}))),function(e){return h.apply(this,arguments)})},{key:"deleteStory",value:(u=(0,a.A)(i().mark((function e(t){var r,n,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._dbPromise;case 3:return r=e.sent,n=r.transaction(p.A.OBJECT_STORE_NAME,"readwrite"),a=n.objectStore(p.A.OBJECT_STORE_NAME),e.abrupt("return",a.delete(t));case 9:throw e.prev=9,e.t0=e.catch(0),e.t0;case 13:case"end":return e.stop()}}),e,this,[[0,9]])}))),function(e){return u.apply(this,arguments)})},{key:"clearStories",value:(c=(0,a.A)(i().mark((function e(){var t,r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._dbPromise;case 3:return t=e.sent,(r=t.transaction(p.A.OBJECT_STORE_NAME,"readwrite")).objectStore(p.A.OBJECT_STORE_NAME).clear(),e.abrupt("return",r.complete);case 10:throw e.prev=10,e.t0=e.catch(0),e.t0;case 14:case"end":return e.stop()}}),e,this,[[0,10]])}))),function(){return c.apply(this,arguments)})},{key:"getBookmarks",value:(n=(0,a.A)(i().mark((function e(){var t,r,n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._dbPromise;case 3:return t=e.sent,r=t.transaction("bookmarks","readonly"),n=r.objectStore("bookmarks"),e.abrupt("return",n.getAll());case 9:throw e.prev=9,e.t0=e.catch(0),e.t0;case 13:case"end":return e.stop()}}),e,this,[[0,9]])}))),function(){return n.apply(this,arguments)})},{key:"addBookmark",value:(r=(0,a.A)(i().mark((function e(t){var r,n,a,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._dbPromise;case 3:return r=e.sent,n=r.transaction("bookmarks","readwrite"),a=n.objectStore("bookmarks"),o={id:"bookmark_".concat(t.id),storyId:t.id,storyData:t,createdAt:(new Date).toISOString()},e.abrupt("return",a.add(o));case 10:throw e.prev=10,e.t0=e.catch(0),e.t0;case 14:case"end":return e.stop()}}),e,this,[[0,10]])}))),function(e){return r.apply(this,arguments)})},{key:"removeBookmark",value:(t=(0,a.A)(i().mark((function e(t){var r,n,a,o,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._dbPromise;case 3:return r=e.sent,n=r.transaction("bookmarks","readwrite"),a=n.objectStore("bookmarks"),o=a.index("storyId"),s=o.get(t),e.abrupt("return",new Promise((function(e,t){s.onsuccess=function(){var t=s.result;e(!!t&&a.delete(t.id))},s.onerror=function(){t(s.error)}})));case 11:throw e.prev=11,e.t0=e.catch(0),e.t0;case 15:case"end":return e.stop()}}),e,this,[[0,11]])}))),function(e){return t.apply(this,arguments)})},{key:"isBookmarked",value:(e=(0,a.A)(i().mark((function e(t){var r,n,a,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._dbPromise;case 3:return r=e.sent,n=r.transaction("bookmarks","readonly"),a=n.objectStore("bookmarks"),o=a.index("storyId"),e.abrupt("return",new Promise((function(e){var r=o.get(t);r.onsuccess=function(){e(!!r.result)},r.onerror=function(){e(!1)}})));case 10:return e.prev=10,e.t0=e.catch(0),e.abrupt("return",!1);case 14:case"end":return e.stop()}}),e,this,[[0,10]])}))),function(t){return e.apply(this,arguments)})}]);var e,t,r,n,c,u,h,l,f,d}());var l=r(702);function f(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return d(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?d(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){c=!0,o=e},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw o}}}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const v=function(){return(0,s.A)((function e(){(0,o.A)(this,e)}),null,[{key:"getAllStories",value:(r=(0,a.A)(i().mark((function e(t){var r,n,a,o,s,c,p,f,d;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.page,n=void 0===r?1:r,a=t.size,o=void 0===a?10:a,s=t.location,c=void 0===s?0:s,e.prev=1,p=l.A.getUserToken(),e.next=5,u.A.getAllStories({token:p,page:n,size:o,location:c});case 5:if(!((f=e.sent).length>0)){e.next=15;break}return e.prev=7,e.next=10,h.putStories(f);case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(7);case 15:return e.abrupt("return",f);case 18:return e.prev=18,e.t1=e.catch(1),e.prev=21,e.next=24,h.getAllStories();case 24:if(!((d=e.sent).length>0)){e.next=27;break}return e.abrupt("return",d);case 27:e.next=32;break;case 29:e.prev=29,e.t2=e.catch(21);case 32:throw e.t1;case 33:case"end":return e.stop()}}),e,null,[[1,18],[7,12],[21,29]])}))),function(e){return r.apply(this,arguments)})},{key:"getStoryDetail",value:(t=(0,a.A)(i().mark((function e(t){var r,n,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=l.A.getUserToken(),e.next=4,u.A.getStoryDetail(t,r);case 4:return n=e.sent,e.prev=5,e.next=8,h.putStory(n);case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(5);case 13:return e.abrupt("return",n);case 16:return e.prev=16,e.t1=e.catch(0),e.prev=19,e.next=22,h.getStory(t);case 22:if(!(a=e.sent)){e.next=25;break}return e.abrupt("return",a);case 25:e.next=30;break;case 27:e.prev=27,e.t2=e.catch(19);case 30:throw e.t1;case 31:case"end":return e.stop()}}),e,null,[[0,16],[5,10],[19,27]])}))),function(e){return t.apply(this,arguments)})},{key:"addNewStory",value:(e=(0,a.A)(i().mark((function e(t){var r,a,o,s,c,p,h,d,v;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.description,a=t.photo,o=t.lat,s=t.lon,e.prev=1,c=l.A.getUserToken(),(p=new FormData).append("description",r),p.append("photo",a),o&&s&&(p.append("lat",o),p.append("lon",s)),h=f(p.entries());try{for(h.s();!(d=h.n()).done;)(v=(0,n.A)(d.value,2))[0],v[1]}catch(e){h.e(e)}finally{h.f()}if(!c){e.next=13;break}return e.next=12,u.A.addNewStory({token:c,data:p});case 12:case 15:return e.abrupt("return",e.sent);case 13:return e.next=15,u.A.addNewStoryGuest({data:p});case 18:throw e.prev=18,e.t0=e.catch(1),new Error(e.t0.message||"Failed to add story. Please try again.");case 22:case"end":return e.stop()}}),e,null,[[1,18]])}))),function(t){return e.apply(this,arguments)})}]);var e,t,r}()}}]);
//# sourceMappingURL=app~7bd12dde.736229ae4a4a8962b3ea.bundle.js.map